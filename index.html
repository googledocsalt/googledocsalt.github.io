<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Google Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/e/ec/GDocs_Favicon_Recreation.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { height: 100%; background: #0f1115; }
    body { height: 100%; font-family: "Inter", sans-serif; background: transparent; color: #ffffff; min-height: 100vh; overflow-x: hidden; }
    #stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; display: block; }
    .site { position: relative; z-index: 1; min-height: 100vh; }
    header { padding: 32px 20px 20px; text-align: center; }
    header h1 { font-size: 2.2rem; font-weight: 700; letter-spacing: -0.5px; }
    header p { margin-top: 8px; color: #9aa0aa; font-size: 0.95rem; }
    .games-wrapper { max-width: 1300px; margin: 0 auto; padding: 20px; }
    .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 18px; }
    .game-card { background: rgba(22,25,34,0.9); border-radius: 18px; overflow: hidden; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; box-shadow: 0 6px 18px rgba(0,0,0,0.25); position: relative; }
    .game-card:hover { transform: translateY(-6px); box-shadow: 0 12px 28px rgba(0,0,0,0.4); }
    .game-thumb { width: 100%; aspect-ratio: 1 / 1; background: #222; background-size: cover; background-position: center; position: relative; }
    .play-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.4); opacity: 0; font-size: 3rem; transition: 0.2s ease; color: #fff; }
    .game-card:hover .play-overlay { opacity: 1; }
    .game-info { padding: 12px 14px 16px; display: flex; align-items: center; justify-content: space-between; gap: 8px; }
    .game-title { font-weight: 600; font-size: 0.95rem; margin-bottom: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .meta-col { display: flex; flex-direction: column; align-items: flex-end; min-width: 60px; }
    .game-meta { font-size: 0.75rem; color: #9aa0aa; }
    .likes { display: inline-flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.03); padding: 6px 10px; border-radius: 999px; font-size: 0.85rem; color: #ffffff; font-weight: 600; }
    .likes .heart { color: #ff6b6b; font-size: 1rem; line-height: 1; margin-left: -2px; }
    .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000; }
    .modal-window { width: 90%; max-width: 1000px; height: 80%; background: #181b24; border-radius: 18px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 0 30px rgba(0,0,0,0.6); }
    .modal-header { padding: 12px 18px; background: #20232d; border-bottom: 1px solid #2a2f3a; display: flex; justify-content: space-between; align-items: center; font-weight: 600; }
    .close-btn { cursor: pointer; font-size: 1.3rem; }
    .game-frame { width: 100%; height: 100%; border: none; background: #000; }
    .modal-footer { padding: 10px; background: #20232d; border-top: 1px solid #2a2f3a; display: flex; justify-content: space-between; align-items: center; }
    .modal-footer .left { display: flex; gap: 8px; align-items: center; }
    .modal-footer button { background: #2c3040; border: none; padding: 10px 14px; border-radius: 10px; color: white; cursor: pointer; transition: 0.2s; }
    .modal-footer button:hover { background: #393f55; }
    @media (max-width:420px) { .meta-col { min-width: 48px; } .game-title { font-size: 0.9rem; } }
  </style>
</head>
<body>
  <canvas id="stars"></canvas>
  <div class="site">
    <header>
      <h1>Unblocked Games</h1>
      <p>Instant play. No limits. Just games.</p>
    </header>
    <main class="games-wrapper">
      <div class="games-grid"></div>
    </main>
  </div>
  <script>
    const githubUser = "googledocsalt";
    const githubRepo = "googledocsalt.github.io";
    const githubBranch = "main";
    const gamesFolder = "assets";
    const countNamespace = "googledocsalt-games";
    const starsCanvas = document.getElementById("stars");
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    let vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    let vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
    function setupCanvas() {
      vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
      vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
      starsCanvas.width = Math.round(vw * dpr);
      starsCanvas.height = Math.round(vh * dpr);
      starsCanvas.style.width = vw + "px";
      starsCanvas.style.height = vh + "px";
      const ctx = starsCanvas.getContext("2d");
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      return ctx;
    }
    let ctx = setupCanvas();
    let stars = [];
    function createStars() {
      const count = Math.round((vw * vh) / 9000);
      stars = new Array(count).fill(0).map(() => {
        return {
          x: Math.random() * vw,
          y: Math.random() * vh,
          r: Math.random() * 1.4 + 0.3,
          speed: Math.random() * 0.25 + 0.03,
          twinkle: Math.random() * Math.PI * 2
        };
      });
    }
    function resizeHandler() {
      ctx = setupCanvas();
      createStars();
    }
    function draw() {
      ctx.clearRect(0, 0, vw, vh);
      for (let i = 0; i < stars.length; i++) {
        const s = stars[i];
        s.y += s.speed;
        s.twinkle += 0.03;
        if (s.y > vh + 10) s.y = -10;
        const alpha = 0.55 + Math.sin(s.twinkle) * 0.45;
        ctx.beginPath();
        ctx.fillStyle = `rgba(255,255,255,${alpha})`;
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
      }
      requestAnimationFrame(draw);
    }
    createStars();
    draw();
    addEventListener("resize", resizeHandler);
    async function findThumbnail(slug) {
      const possible = ["png", "jpg", "jpeg", "webp"];
      for (const ext of possible) {
        const local = `${gamesFolder}/${slug}.${ext}`;
        try {
          const res = await fetch(local);
          if (res.ok) return local;
        } catch {}
      }
      for (const ext of possible) {
        const git = `https://raw.githubusercontent.com/${githubUser}/${githubRepo}/${githubBranch}/assets/${slug}.${ext}`;
        try {
          const res = await fetch(git);
          if (res.ok) return git;
        } catch {}
      }
      return "https://via.placeholder.com/300x300?text=No+Image";
    }
    async function loadGameFiles() {
      const api = `https://api.github.com/repos/${githubUser}/${githubRepo}/contents/${gamesFolder}`;
      const res = await fetch(api);
      const files = await res.json();
      return files
        .filter(f => f && f.name && f.name.endsWith(".html"))
        .map(f => {
          const slug = f.name.replace(".html", "");
          const title = slug.replace(/-/g, " ");
          return { slug, title };
        });
    }
    function createGameCard(game, thumb, likes) {
      const safeTitle = game.title.replace(/'/g, "\\'");
      return `
        <div class="game-card" data-slug="${game.slug}" onclick="openGame('${game.slug}', '${safeTitle}')">
          <div class="game-thumb" style="background-image:url('${thumb}')">
            <div class="play-overlay">‚ñ∂</div>
          </div>
          <div class="game-info">
            <div style="min-width:0">
              <div class="game-title">${game.title}</div>
              <div class="game-meta">Play Now</div>
            </div>
            <div class="meta-col">
              <div class="likes"><span class="heart">‚ù§</span><span class="likes-count">${likes}</span></div>
            </div>
          </div>
        </div>
      `;
    }
    function openGame(slug, title) {
      const modal = document.createElement("div");
      modal.className = "modal-bg";
      modal.innerHTML = `
        <div class="modal-window">
          <div class="modal-header">
            <span>${title}</span>
            <span class="close-btn" onclick="this.closest('.modal-bg').remove()">‚úñ</span>
          </div>
          <iframe src="assets/${slug}.html" class="game-frame"></iframe>
          <div class="modal-footer">
            <div class="left">
              <button id="like-btn" onclick="likeGame('${slug}', this)">üëç Like</button>
              <div class="likes" id="modal-likes"><span class="heart">‚ù§</span><span class="likes-count">...</span></div>
            </div>
            <div>
              <button onclick="fullscreenGame(this)">‚õ∂ Fullscreen</button>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      updateModalLikes(slug);
    }
    function fullscreenGame(btn) {
      const frame = btn.closest(".modal-window").querySelector(".game-frame");
      if (frame && frame.requestFullscreen) frame.requestFullscreen();
    }
    async function getGlobalLikes(slug) {
      try {
        const res = await fetch(`https://api.countapi.xyz/get/${countNamespace}/${encodeURIComponent(slug)}`);
        if (!res.ok) return 0;
        const data = await res.json();
        return data.value || 0;
      } catch {
        return 0;
      }
    }
    async function hitGlobalLike(slug) {
      try {
        const res = await fetch(`https://api.countapi.xyz/hit/${countNamespace}/${encodeURIComponent(slug)}`);
        if (!res.ok) return null;
        const data = await res.json();
        return data.value || null;
      } catch {
        return null;
      }
    }
    function updateCardLikes(slug, value) {
      const el = document.querySelector(`.game-card[data-slug="${slug}"] .likes-count`);
      if (el) el.textContent = value;
    }
    async function updateModalLikes(slug) {
      const el = document.getElementById("modal-likes");
      if (!el) return;
      const countEl = el.querySelector(".likes-count");
      countEl.textContent = "‚Ä¶";
      const v = await getGlobalLikes(slug);
      countEl.textContent = v;
      const likeBtn = document.getElementById("like-btn");
      if (localStorage.getItem("liked_" + slug)) {
        if (likeBtn) {
          likeBtn.disabled = true;
          likeBtn.textContent = "üëç Liked";
        }
      } else {
        if (likeBtn) {
          likeBtn.disabled = false;
          likeBtn.textContent = "üëç Like";
        }
      }
    }
    async function likeGame(slug, btn) {
      if (localStorage.getItem("liked_" + slug)) {
        alert("You already liked this game from this device.");
        return;
      }
      if (btn) {
        btn.disabled = true;
        btn.textContent = "‚Ä¶";
      }
      const v = await hitGlobalLike(slug);
      if (v === null) {
        if (btn) {
          btn.disabled = false;
          btn.textContent = "üëç Like";
        }
        alert("Could not register like. Try again later.");
        return;
      }
      localStorage.setItem("liked_" + slug, "1");
      updateCardLikes(slug, v);
      const modalLikesEl = document.getElementById("modal-likes");
      if (modalLikesEl) modalLikesEl.querySelector(".likes-count").textContent = v;
      if (btn) btn.textContent = "üëç Liked";
      alert(`Thanks! Total likes: ${v}`);
    }
    (async () => {
      const container = document.querySelector(".games-grid");
      container.innerHTML = `<div style="color:#888;text-align:center;">Loading games‚Ä¶</div>`;
      const games = await loadGameFiles();
      container.innerHTML = "";
      const likesPromises = games.map(g => getGlobalLikes(g.slug));
      const likesResults = await Promise.all(likesPromises);
      for (let i = 0; i < games.length; i++) {
        const g = games[i];
        const thumb = await findThumbnail(g.slug);
        const likes = likesResults[i] || 0;
        container.innerHTML += createGameCard(g, thumb, likes);
      }
    })();
  </script>
</body>
</html>